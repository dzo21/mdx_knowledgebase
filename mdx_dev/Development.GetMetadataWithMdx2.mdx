// public DbSchemaDto GetSchema(DDInt.IUdmConnection aUdmConnection)
SELECT [CUBE_NAME]
	,[CUBE_CAPTION]
FROM $SYSTEM.MDSchema_Cubes
WHERE CUBE_SOURCE = 1


// public DbCubeSchemaDto GetCubeSchema(DDInt.IUdmConnection aUdmConnection, string aCubeUniqueName)
SELECT [MEASUREGROUP_NAME]
	,[MEASUREGROUP_CAPTION]
FROM $SYSTEM.MDSchema_MeasureGroups
WHERE [CATALOG_NAME] = 'AdventureWorksDW'
	AND [CUBE_NAME] = 'Adventure Works'

// public DbCubeSchemaDto GetCubeSchema(DDInt.IUdmConnection aUdmConnection, string aCubeUniqueName)
SELECT [DIMENSION_NAME]
	,[DIMENSION_CAPTION]
	,[DIMENSION_UNIQUE_NAME]
FROM $SYSTEM.MDSchema_Dimensions
WHERE [CATALOG_NAME] = 'AdventureWorksDW'
	AND [CUBE_NAME] = 'Adventure Works'

// public DbCubeSchemaDto GetCubeSchema(DDInt.IUdmConnection aUdmConnection, string aCubeUniqueName)
SELECT [HIERARCHY_NAME]
	,[HIERARCHY_CAPTION]
	,[HIERARCHY_UNIQUE_NAME]
	,[DEFAULT_MEMBER]
	,[ALL_MEMBER]
	,[HIERARCHY_ORIGIN]
FROM $SYSTEM.MDSchema_Hierarchies
WHERE [CATALOG_NAME] = 'AdventureWorksDW'
	AND [CUBE_NAME] = 'Adventure Works'

// public DbHierarchySchemaDto GetHierarchySchema(DDInt.IUdmConnection aUdmConnection, string aHierarchyUniqueName)
SELECT [LEVEL_NAME]
	,[LEVEL_CAPTION]
	,[LEVEL_UNIQUE_NAME]
	,[LEVEL_NUMBER]
FROM $SYSTEM.MDSchema_Levels
WHERE [CATALOG_NAME] = 'AdventureWorksDW'
	// AND [CUBE_NAME] = 'Adventure Works'
	AND [HIERARCHY_	UNIQUE_NAME] = '[Product].[Product Categories]'


--All Levels of Hierarchies (user-defined) 
SELECT [CATALOG_NAME] AS [DATABASE]
	,CUBE_NAME AS [CUBE]
	,[DIMENSION_UNIQUE_NAME] AS [DIMENSION]
	,[HIERARCHY_UNIQUE_NAME] AS [HIERARCHY]
	,LEVEL_CAPTION AS [LEVEL]
	,[LEVEL_NAME]
	,[LEVEL_NUMBER] AS [LEVEL NUMBER]
	,[LEVEL_NAME_SQL_COLUMN_NAME] AS [NAME_COLUMN]
	,[LEVEL_UNIQUE_NAME_SQL_COLUMN_NAME] AS [UNIQUE_NAME_COLUMN]
	,[LEVEL_KEY_SQL_COLUMN_NAME] AS [KEY_COLUMN]
FROM $SYSTEM.MDSchema_levels
WHERE CUBE_NAME = 'Adventure Works'
	AND level_origin = 1
ORDER BY [DIMENSION_UNIQUE_NAME]
 
--Calculated Measures/Members 
SELECT [MEMBER_UNIQUE_NAME] AS [CALCULATED_MEASURE]
	,[MEMBER_CAPTION] AS [CAPTION]
	,[EXPRESSION]
FROM $SYSTEM.MDSCHEMA_MEMBERS
WHERE CUBE_NAME = 'Adventure Works'
	AND [MEMBER_TYPE] = 4 --MDMEMBER_TYPE_FORMULA
 
--Dimension Usage/Fact-Dimension Bus Matrix 
SELECT [MEASUREGROUP_NAME] AS [MEASUREGROUP]
	,[MEASUREGROUP_CARDINALITY]
	,[DIMENSION_UNIQUE_NAME] AS [DIM]
	,[DIMENSION_GRANULARITY] AS [DIM_KEY]
	,[DIMENSION_CARDINALITY]
	,[DIMENSION_IS_VISIBLE] AS [IS_VISIBLE]
	,[DIMENSION_IS_FACT_DIMENSION] AS [IS_FACT_DIM]
FROM $SYSTEM.MDSCHEMA_MEASUREGROUP_DIMENSIONS
WHERE [CUBE_NAME] = 'Adventure Works'
	AND [MEASUREGROUP_NAME] = 'Internet Sales'



